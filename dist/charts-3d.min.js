!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n(require("d3")):"function"==typeof define&&define.amd?define(["d3"],n):(t=t||self).Charts3D=n(t.d3)}(this,function(A){"use strict";var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function n(t,n){return t(n={exports:{}},n.exports),n.exports}function e(t){return t&&t.Math==Math&&t}function u(t){try{return!!t()}catch(t){return!0}}function r(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}function w(t){return c.call(t).slice(8,-1)}function l(t){if(null==t)throw TypeError("Can't call method on "+t);return t}function s(t){return m(l(t))}function f(t){return"object"==typeof t?null!==t:"function"==typeof t}function p(t,n){if(!f(t))return t;var e,r;if(n&&"function"==typeof(e=t.toString)&&!f(r=e.call(t)))return r;if("function"==typeof(e=t.valueOf)&&!f(r=e.call(t)))return r;if(!n&&"function"==typeof(e=t.toString)&&!f(r=e.call(t)))return r;throw TypeError("Can't convert object to primitive value")}function d(t,n){return x.call(t,n)}function o(t){return E?S.createElement(t):{}}function P(t){if(!f(t))throw TypeError(String(t)+" is not an object");return t}function g(n,e){try{_(h,n,e)}catch(t){h[n]=e}return e}var h=e("object"==typeof globalThis&&globalThis)||e("object"==typeof window&&window)||e("object"==typeof self&&self)||e("object"==typeof t&&t)||Function("return this")(),v=!u(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),i={}.propertyIsEnumerable,a=Object.getOwnPropertyDescriptor,y={f:a&&!i.call({1:2},1)?function(t){var n=a(this,t);return!!n&&n.enumerable}:i},c={}.toString,b="".split,m=u(function(){return!Object("z").propertyIsEnumerable(0)})?function(t){return"String"==w(t)?b.call(t,""):Object(t)}:Object,x={}.hasOwnProperty,S=h.document,E=f(S)&&f(S.createElement),j=!v&&!u(function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}),O=Object.getOwnPropertyDescriptor,I={f:v?O:function(t,n){if(t=s(t),n=p(n,!0),j)try{return O(t,n)}catch(t){}if(d(t,n))return r(!y.f.call(t,n),t[n])}},M=Object.defineProperty,T={f:v?M:function(t,n,e){if(P(t),n=p(n,!0),P(e),j)try{return M(t,n,e)}catch(t){}if("get"in e||"set"in e)throw TypeError("Accessors not supported");return"value"in e&&(t[n]=e.value),t}},_=v?function(t,n,e){return T.f(t,n,r(1,e))}:function(t,n,e){return t[n]=e,t},N="__core-js_shared__",R=h[N]||g(N,{}),L=Function.toString;"function"!=typeof R.inspectSource&&(R.inspectSource=function(t){return L.call(t)});function C(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++q+H).toString(36)}function k(t){return J[t]||(J[t]=C(t))}var z,$,F,U,D,G,B,K,V=R.inspectSource,X=h.WeakMap,Y="function"==typeof X&&/native code/.test(V(X)),W=n(function(t){(t.exports=function(t,n){return R[t]||(R[t]=void 0!==n?n:{})})("versions",[]).push({version:"3.6.5",mode:"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})}),q=0,H=Math.random(),J=W("keys"),Q={},Z=h.WeakMap;B=Y?(z=new Z,$=z.get,F=z.has,U=z.set,D=function(t,n){return U.call(z,t,n),n},G=function(t){return $.call(z,t)||{}},function(t){return F.call(z,t)}):(K=k("state"),Q[K]=!0,D=function(t,n){return _(t,K,n),n},G=function(t){return d(t,K)?t[K]:{}},function(t){return d(t,K)});function tt(t){return"function"==typeof t?t:void 0}function nt(t,n){return arguments.length<2?tt(ft[t])||tt(h[t]):ft[t]&&ft[t][n]||h[t]&&h[t][n]}function et(t){return isNaN(t=+t)?0:(0<t?dt:pt)(t)}function rt(t){return 0<t?gt(et(t),9007199254740991):0}function ot(l){return function(t,n,e){var r,o,i,a=s(t),c=rt(a.length),u=(r=c,(o=et(e))<0?ht(o+r,0):vt(o,r));if(l&&n!=n){for(;u<c;)if((i=a[u++])!=i)return!0}else for(;u<c;u++)if((l||u in a)&&a[u]===n)return l||u||0;return!l&&-1}}function it(t,n){var e,r=s(t),o=0,i=[];for(e in r)!d(Q,e)&&d(r,e)&&i.push(e);for(;n.length>o;)d(r,e=n[o++])&&(~yt(i,e)||i.push(e));return i}function at(t,n){var e=Ot[jt(t)];return e==Mt||e!=It&&("function"==typeof n?u(n):!!n)}function ct(t,n){var e,r,o,i,a=t.target,c=t.global,u=t.stat,l=c?h:u?h[a]||g(a,{}):(h[a]||{}).prototype;if(l)for(e in n){if(o=n[e],r=t.noTargetGet?(i=Pt(l,e))&&i.value:l[e],!wt(c?e:a+(u?".":"#")+e,t.forced)&&void 0!==r){if(typeof o==typeof r)continue;!function(t,n){for(var e=St(n),r=T.f,o=I.f,i=0;i<e.length;i++){var a=e[i];d(t,a)||r(t,a,o(n,a))}}(o,r)}(t.sham||r&&r.sham)&&_(o,"sham",!0),st(l,e,o,t)}}function ut(t){return Object(l(t))}var lt={set:D,get:G,has:B,enforce:function(t){return B(t)?G(t):D(t,{})},getterFor:function(e){return function(t){var n;if(!f(t)||(n=G(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}},st=n(function(t){var n=lt.get,c=lt.enforce,u=String(String).split("String");(t.exports=function(t,n,e,r){var o=!!r&&!!r.unsafe,i=!!r&&!!r.enumerable,a=!!r&&!!r.noTargetGet;"function"==typeof e&&("string"!=typeof n||d(e,"name")||_(e,"name",n),c(e).source=u.join("string"==typeof n?n:"")),t!==h?(o?!a&&t[n]&&(i=!0):delete t[n],i?t[n]=e:_(t,n,e)):i?t[n]=e:g(n,e)})(Function.prototype,"toString",function(){return"function"==typeof this&&n(this).source||V(this)})}),ft=h,pt=Math.ceil,dt=Math.floor,gt=Math.min,ht=Math.max,vt=Math.min,yt={includes:ot(!0),indexOf:ot(!1)}.indexOf,bt=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],At=bt.concat("length","prototype"),mt={f:Object.getOwnPropertyNames||function(t){return it(t,At)}},xt={f:Object.getOwnPropertySymbols},St=nt("Reflect","ownKeys")||function(t){var n=mt.f(P(t)),e=xt.f;return e?n.concat(e(t)):n},Et=/#|\.prototype\./,jt=at.normalize=function(t){return String(t).replace(Et,".").toLowerCase()},Ot=at.data={},It=at.NATIVE="N",Mt=at.POLYFILL="P",wt=at,Pt=I.f,Tt=Object.keys||function(t){return it(t,bt)},_t=Object.assign,Nt=Object.defineProperty,Rt=!_t||u(function(){if(v&&1!==_t({b:1},_t(Nt({},"a",{enumerable:!0,get:function(){Nt(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return 1;var t={},n={},e=Symbol(),r="abcdefghijklmnopqrst";return t[e]=7,r.split("").forEach(function(t){n[t]=t}),7!=_t({},t)[e]||Tt(_t({},n)).join("")!=r})?function(t,n){for(var e=ut(t),r=arguments.length,o=1,i=xt.f,a=y.f;o<r;)for(var c,u=m(arguments[o++]),l=i?Tt(u).concat(i(u)):Tt(u),s=l.length,f=0;f<s;)c=l[f++],v&&!a.call(u,c)||(e[c]=u[c]);return e}:_t;ct({target:"Object",stat:!0,forced:Object.assign!==Rt},{assign:Rt});var Lt,Ct,kt=[].join,zt=m!=Object,$t=(Lt=",",!!(Ct=[]["join"])&&u(function(){Ct.call(null,Lt||function(){throw 1},1)}));ct({target:"Array",proto:!0,forced:zt||!$t},{join:function(t){return kt.call(s(this),void 0===t?",":t)}});function Ft(){}function Ut(t){return"<script>"+t+"</"+Xt+">"}var Dt,Gt=Object.setPrototypeOf||("__proto__"in{}?function(){var e,r=!1,t={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(t,[]),r=t instanceof Array}catch(t){}return function(t,n){return P(t),function(t){if(!f(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype")}(n),r?e.call(t,n):t.__proto__=n,t}}():void 0),Bt=v?Object.defineProperties:function(t,n){P(t);for(var e,r=Tt(n),o=r.length,i=0;i<o;)T.f(t,e=r[i++],n[e]);return t},Kt=nt("document","documentElement"),Vt="prototype",Xt="script",Yt=k("IE_PROTO"),Wt=function(){try{Dt=document.domain&&new ActiveXObject("htmlfile")}catch(t){}var t,n;Wt=Dt?function(t){t.write(Ut("")),t.close();var n=t.parentWindow.Object;return t=null,n}(Dt):((n=o("iframe")).style.display="none",Kt.appendChild(n),n.src=String("javascript:"),(t=n.contentWindow.document).open(),t.write(Ut("document.F=Object")),t.close(),t.F);for(var e=bt.length;e--;)delete Wt[Vt][bt[e]];return Wt()};Q[Yt]=!0;function qt(e){return function(t){var n=String(l(t));return 1&e&&(n=n.replace(Zt,"")),2&e&&(n=n.replace(tn,"")),n}}function Ht(t){var n,e,r,o,i,a,c,u,l=p(t,!1);if("string"==typeof l&&2<l.length)if(43===(n=(l=an(l)).charCodeAt(0))||45===n){if(88===(e=l.charCodeAt(2))||120===e)return NaN}else if(48===n){switch(l.charCodeAt(1)){case 66:case 98:r=2,o=49;break;case 79:case 111:r=8,o=55;break;default:return+l}for(a=(i=l.slice(2)).length,c=0;c<a;c++)if((u=i.charCodeAt(c))<48||o<u)return NaN;return parseInt(i,r)}return+l}var Jt=Object.create||function(t,n){var e;return null!==t?(Ft[Vt]=P(t),e=new Ft,Ft[Vt]=null,e[Yt]=t):e=Wt(),void 0===n?e:Bt(e,n)},Qt="[\t\n\v\f\r                　\u2028\u2029\ufeff]",Zt=RegExp("^"+Qt+Qt+"*"),tn=RegExp(Qt+Qt+"*$"),nn={start:qt(1),end:qt(2),trim:qt(3)},en=mt.f,rn=I.f,on=T.f,an=nn.trim,cn="Number",un=h[cn],ln=un.prototype,sn=w(Jt(ln))==cn;if(wt(cn,!un(" 0o1")||!un("0b1")||un("+0x1"))){for(var fn,pn=function(t){var n,e,r,o,i,a=arguments.length<1?0:t,c=this;return c instanceof pn&&(sn?u(function(){ln.valueOf.call(c)}):w(c)!=cn)?(n=new un(Ht(a)),e=c,r=pn,Gt&&"function"==typeof(o=e.constructor)&&o!==r&&f(i=o.prototype)&&i!==r.prototype&&Gt(n,i),n):Ht(a)},dn=v?en(un):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),gn=0;dn.length>gn;gn++)d(un,fn=dn[gn])&&!d(pn,fn)&&on(pn,fn,rn(un,fn));(pn.prototype=ln).constructor=pn,st(h,cn,pn)}function hn(t){return d(bn,t)||(vn&&d(An,t)?bn[t]=An[t]:bn[t]=mn("Symbol."+t)),bn[t]}var vn=!!Object.getOwnPropertySymbols&&!u(function(){return!String(Symbol())}),yn=vn&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,bn=W("wks"),An=h.Symbol,mn=yn?An:An&&An.withoutSetter||C,xn={};xn[hn("toStringTag")]="z";var Sn="[object z]"===String(xn),En=hn("toStringTag"),jn="Arguments"==w(function(){return arguments}()),On=Sn?w:function(t){var n,e,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(e=function(t,n){try{return t[n]}catch(t){}}(n=Object(t),En))?e:jn?w(n):"Object"==(r=w(n))&&"function"==typeof n.callee?"Arguments":r},In=Sn?{}.toString:function(){return"[object "+On(this)+"]"};Sn||st(Object.prototype,"toString",In,{unsafe:!0});function Mn(){var t=P(this),n="";return t.global&&(n+="g"),t.ignoreCase&&(n+="i"),t.multiline&&(n+="m"),t.dotAll&&(n+="s"),t.unicode&&(n+="u"),t.sticky&&(n+="y"),n}function wn(t,n){return RegExp(t,n)}var Pn,Tn,_n={UNSUPPORTED_Y:u(function(){var t=wn("a","y");return t.lastIndex=2,null!=t.exec("abcd")}),BROKEN_CARET:u(function(){var t=wn("^r","gy");return t.lastIndex=2,null!=t.exec("str")})},Nn=RegExp.prototype.exec,Rn=String.prototype.replace,Ln=Nn,Cn=(Pn=/a/,Tn=/b*/g,Nn.call(Pn,"a"),Nn.call(Tn,"a"),0!==Pn.lastIndex||0!==Tn.lastIndex),kn=_n.UNSUPPORTED_Y||_n.BROKEN_CARET,zn=void 0!==/()??/.exec("")[1];(Cn||zn||kn)&&(Ln=function(t){var n,e,r,o,i=this,a=kn&&i.sticky,c=Mn.call(i),u=i.source,l=0,s=t;return a&&(-1===(c=c.replace("y","")).indexOf("g")&&(c+="g"),s=String(t).slice(i.lastIndex),0<i.lastIndex&&(!i.multiline||i.multiline&&"\n"!==t[i.lastIndex-1])&&(u="(?: "+u+")",s=" "+s,l++),e=new RegExp("^(?:"+u+")",c)),zn&&(e=new RegExp("^"+u+"$(?!\\s)",c)),Cn&&(n=i.lastIndex),r=Nn.call(a?e:i,s),a?r?(r.input=r.input.slice(l),r[0]=r[0].slice(l),r.index=i.lastIndex,i.lastIndex+=r[0].length):i.lastIndex=0:Cn&&r&&(i.lastIndex=i.global?r.index+r[0].length:n),zn&&r&&1<r.length&&Rn.call(r[0],e,function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(r[o]=void 0)}),r});var $n=Ln;ct({target:"RegExp",proto:!0,forced:/./.exec!==$n},{exec:$n});var Fn="toString",Un=RegExp.prototype,Dn=Un[Fn],Gn=u(function(){return"/a/b"!=Dn.call({source:"a",flags:"b"})}),Bn=Dn.name!=Fn;(Gn||Bn)&&st(RegExp.prototype,Fn,function(){var t=P(this),n=String(t.source),e=t.flags;return"/"+n+"/"+String(void 0===e&&t instanceof RegExp&&!("flags"in Un)?Mn.call(t):e)},{unsafe:!0});function Kn(c){return function(t,n){var e,r,o=String(l(t)),i=et(n),a=o.length;return i<0||a<=i?c?"":void 0:(e=o.charCodeAt(i))<55296||56319<e||i+1===a||(r=o.charCodeAt(i+1))<56320||57343<r?c?o.charAt(i):e:c?o.slice(i,i+2):r-56320+(e-55296<<10)+65536}}var Vn,Xn,Yn,Wn,qn,Hn,Jn,Qn,Zn,te,ne,ee=hn("species"),re=!u(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}),oe="$0"==="a".replace(/./,"$0"),ie=hn("replace"),ae=!!/./[ie]&&""===/./[ie]("a","$0"),ce=!u(function(){var t=/(?:)/,n=t.exec;t.exec=function(){return n.apply(this,arguments)};var e="ab".split(t);return 2!==e.length||"a"!==e[0]||"b"!==e[1]}),ue={codeAt:Kn(!1),charAt:Kn(!0)}.charAt,le=Math.max,se=Math.min,fe=Math.floor,pe=/\$([$&'`]|\d\d?|<[^>]*>)/g,de=/\$([$&'`]|\d\d?)/g;function ge(t){return t.oldEndAngle?t.oldSartAngle+(t.oldEndAngle-t.oldSartAngle)/2:t.startAngle+(t.endAngle-t.startAngle)/2}function he(t,n){return n&&n.colors&&n.colors.pies.length?n.colors.pies[t]:A.schemeCategory10[t]}Xn=2,Yn=function(o,E,j,t){var O=t.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,I=t.REPLACE_KEEPS_$0,M=O?"$":"$0";return[function(t,n){var e=l(this),r=null==t?void 0:t[o];return void 0!==r?r.call(t,e,n):E.call(String(e),t,n)},function(t,n){if(!O&&I||"string"==typeof n&&-1===n.indexOf(M)){var e=j(E,t,this,n);if(e.done)return e.value}var r=P(t),o=String(this),i="function"==typeof n;i||(n=String(n));var a,c=r.global;c&&(a=r.unicode,r.lastIndex=0);for(var u,l,s=[];;){var f=function(t,n){var e=t.exec;if("function"==typeof e){var r=e.call(t,n);if("object"!=typeof r)throw TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==w(t))throw TypeError("RegExp#exec called on incompatible receiver");return $n.call(t,n)}(r,o);if(null===f)break;if(s.push(f),!c)break;""===String(f[0])&&(r.lastIndex=(u=o,(l=rt(r.lastIndex))+(a?ue(u,l).length:1)))}for(var p,d="",g=0,h=0;h<s.length;h++){f=s[h];for(var v=String(f[0]),y=le(se(et(f.index),o.length),0),b=[],A=1;A<f.length;A++)b.push(void 0===(p=f[A])?p:String(p));var m,x=f.groups,S=i?(m=[v].concat(b,y,o),void 0!==x&&m.push(x),String(n.apply(void 0,m))):function(i,a,c,u,l,t){var s=c+i.length,f=u.length,n=de;void 0!==l&&(l=ut(l),n=pe);return E.call(t,n,function(t,n){var e;switch(n.charAt(0)){case"$":return"$";case"&":return i;case"`":return a.slice(0,c);case"'":return a.slice(s);case"<":e=l[n.slice(1,-1)];break;default:var r=+n;if(0==r)return t;if(f<r){var o=fe(r/10);return 0===o?t:o<=f?void 0===u[o-1]?n.charAt(1):u[o-1]+n.charAt(1):t}e=u[r-1]}return void 0===e?"":e})}(v,o,y,b,x,n);g<=y&&(d+=o.slice(g,y)+S,g=y+v.length)}return d+o.slice(g)}]},Zn=hn(Vn="replace"),te=!u(function(){var t={};return t[Zn]=function(){return 7},7!=""[Vn](t)}),ne=te&&!u(function(){var t=!1,n=/a/;return"split"===Vn&&((n={constructor:{}}).constructor[ee]=function(){return n},n.flags="",n[Zn]=/./[Zn]),n.exec=function(){return t=!0,null},n[Zn](""),!t}),te&&ne&&("replace"!==Vn||re&&oe&&!ae)&&("split"!==Vn||ce)||(qn=/./[Zn],Jn=(Hn=Yn(Zn,""[Vn],function(t,n,e,r,o){return n.exec===$n?te&&!o?{done:!0,value:qn.call(n,e,r)}:{done:!0,value:t.call(e,n,r)}:{done:!1}},{REPLACE_KEEPS_$0:oe,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:ae}))[0],Qn=Hn[1],st(String.prototype,Vn,Jn),st(RegExp.prototype,Zn,2==Xn?function(t,n){return Qn.call(t,this,n)}:function(t){return Qn.call(t,this)})),Wn&&_(RegExp.prototype[Zn],"sham",!0);var ve=function(){function t(t){var n;this.opts={title:{text:"",top:0,left:0,fontSize:"",color:""},deep:20,angle:45,ir:.3,size:100,fontSize:"12px",colors:{pies:[],label:""},animationDuration:700,labelText:function(t){return t.data.title+"("+Math.round((t.endAngle-t.startAngle)/(2*Math.PI)*100)+"%)"}},this.options=((n=Object.assign({},this.opts,t)).rx=n.width/4*n.size/100,n.ry=n.rx*n.angle/90,90===n.angle&&(n.deep=0),n)}return t.prototype.draw=function(t){var e=this,n=this.options,r=n.idSvg,o=n.width,i=n.height,h=n.rx,v=n.ry,y=n.ir,b=n.deep,a=n.animationDuration;A.select("#"+r+" #main").remove();var c=A.pie().value(function(t){return t.value})(t),u=A.select("#"+r).append("g").attr("id","main").attr("transform","translate("+o/2+", "+i/2+")"),l=this.options.title,s=l.top,f=l.fontSize,p=l.color;this.options.title&&u.append("text").text(this.options.title.text).attr("transform","translate(0, "+-(i/2-20-Number(s.toString().replace("px","")))+")").attr("text-anchor","middle").attr("font-size",f).attr("fill",p),u.append("g").selectAll(".walls").data(c,function(t){return t.data.id}).join("path").attr("class","walls").attr("fill",function(t,n){return he(n,e.options)}).transition().duration(a).attrTween("d",function(f){var p={};return Object.assign(p,f),function(t){return p.endAngle=f.startAngle+(f.endAngle-f.startAngle)*t,n=p,r=v,o=b,i=y,a=(e=h)*Math.cos(n.startAngle),c=r*Math.sin(n.startAngle),u=e*Math.cos(n.endAngle),l=r*Math.sin(n.endAngle),(s=[]).push("M",i*u,i*l,"L",i*u,i*l+o,"L",u,l+o,"L",u,l,"z"),s.push("M",i*a,i*c,"L",i*a,i*c+o,"L",a,c+o,"L",a,c,"z"),s.join(" ");var n,e,r,o,i,a,c,u,l,s}}),u.append("g").selectAll(".pieInner").data(c,function(t){return t.data.id}).join("path").attr("class","pieInner").attr("fill",function(t,n){return A.hsl(he(n,e.options)).darker(.8)}).transition().duration(a).attrTween("d",function(d){var g=A.interpolate(d.startAngle,d.endAngle);return function(t){return d.endAngle=g(t),e=h,r=v,o=y,i=b,a=(n=d).startAngle<Math.PI?Math.PI:n.startAngle,c=n.endAngle<Math.PI?Math.PI:n.endAngle,u=o*e*Math.cos(a),l=o*r*Math.sin(a),s=o*e*Math.cos(c),f=o*r*Math.sin(c),(p=[]).push("M",u,l,"A",o*e,o*r,"0 0 1",s,f,"L",s,i+f,"A",o*e,o*r,"0 0 0",u,i+l,"z"),p.join(" ");var n,e,r,o,i,a,c,u,l,s,f,p}}),u.append("g").selectAll(".pieTop").data(c,function(t){return t.data.id}).join("path").attr("class","pieTop").style("cursor","pointer").transition().duration(a).attrTween("d",function(n){var e=A.interpolate(n.startAngle,n.endAngle);return function(t){return n.endAngle=e(t),function(t,n,e,r){if(t.endAngle-t.startAngle==0)return"M 0 0";var o=n*Math.cos(t.startAngle),i=e*Math.sin(t.startAngle),a=n*Math.cos(t.endAngle),c=e*Math.sin(t.endAngle),u=[];return u.push("M",o,i,"A",n,e,"0",t.endAngle-t.startAngle>Math.PI?1:0,"1",a,c,"L",r*a,r*c),u.push("A",r*n,r*e,"0",t.endAngle-t.startAngle>Math.PI?1:0,"0",r*o,r*i,"z"),u.join(" ")}(n,h,v,y)}}).attr("fill",function(t,n){return he(n,e.options)}).on("end",function(t,n){var e=A.select(this);e.isMoved=!1,e.on("click",function(){}),e.on("mouseover",function(){A.select(".tips-"+n).style("opacity","1").style("cursor","pointer")}),e.on("mouseout",function(){A.select(".tips-"+n).style("opacity","0")})}),u.append("g").selectAll(".pieOuter").data(c,function(t){return t.data.id}).join("path").attr("class","pieOuter").transition().duration(a).attrTween("d",function(p){var d=A.interpolate(p.startAngle,p.endAngle);return function(t){return p.endAngle=d(t),e=h,r=v,o=b,i=(n=p).startAngle>Math.PI?Math.PI:n.startAngle,a=n.endAngle>Math.PI?Math.PI:n.endAngle,c=e*Math.cos(i),u=r*Math.sin(i),l=e*Math.cos(a),s=r*Math.sin(a),(f=[]).push("M",c,o+u,"A",e,r,"0 0 1",l,o+s,"L",l,s,"A",e,r,"0 0 0",c,u,"z"),f.join(" ");var n,e,r,o,i,a,c,u,l,s,f}}).attr("fill",function(t,n){return A.hsl(he(n,e.options)).darker(.6)}),u.append("g").selectAll(".label-line").data(c,function(t){return t.data.id}).join("path").attr("class","label-line").style("stroke",function(t,n){return A.hsl(he(n,e.options)).darker(.2)}).transition().duration(a).attrTween("d",function(l){var s={};return Object.assign(s,l),function(t){return s.endAngle=l.startAngle+(l.endAngle-l.startAngle)*t,n=s,r=v,o=b,i=(e=h)*Math.cos(ge(n)),a=r*Math.sin(ge(n)),(u=[]).push("M",i,a,"L",i*(c=1+o/e/2),a*c),u.push("L",(e+20)*(ge(n)>1.5*Math.PI||ge(n)<Math.PI/2?1:-1),a*c),u.push("L",i*c,a*c,"z"),u.join(" ");var n,e,r,o,i,a,c,u}}),u.append("g").selectAll(".label").data(c,function(t){return t.data.id}).join("text").attr("class","label").text(this.options.labelText).attr("fill",this.options.colors.label).attr("font-size",this.options.fontSize||"1em").transition().duration(a).attrTween("transform",function(t){return function(e,t){var r=t.rx,o=t.ry,i=t.deep,a=1;e.endAngle-e.startAngle<18*Math.PI/180&&(a=.8);var c={};return Object.assign(c,e),function(t){c.endAngle=e.startAngle+(e.endAngle-e.startAngle)*t;var n=1+i/r/2;return"\n            translate("+(r+20)*(ge(c)>1.5*Math.PI||ge(c)<Math.PI/2?1:-1)+",\n                    "+o*Math.sin(ge(c))*n+")\n            scale("+a+")"}}(t,e.options)}).styleTween("text-anchor",function(t){return n=t,e={},Object.assign(e,n),function(t){return e.endAngle=n.startAngle+(n.endAngle-n.startAngle)*t,ge(e)>1.5*Math.PI||ge(e)<Math.PI/2?"start":"end"};var n,e}),u.append("g").selectAll(".tips").data(c,function(t){return t.data.id}).join("text").attr("class",function(t,n){return"tips tips-"+n}).text(function(t){return t.value}).attr("dominant-baseline","middle").attr("text-anchor","middle").attr("x",function(t){return(h+h*y)/2*Math.cos(ge(t))}).attr("y",function(t){return(v+v*y)/2*Math.sin(ge(t))}).style("font-size",".8em").style("opacity","0").on("mouseover",function(){A.select(this).style("opacity","1")}).on("mouseout",function(){A.select(this).style("opacity","0")})},t}(),ye={select:"body",type:"pie3d",idSvg:"",width:0,height:0};return function(){function n(t){this.setOptions(t),this.draw()}var t=n.prototype;return t.setOptions=function(t){this.options=Object.assign({},ye,t),this.options.idSvg="svg-"+Date.now();var n=A.select(this.options.select).node().getBoundingClientRect();this.options.width=n.width,this.options.height=n.height},t.draw=function(){A.select(this.options.select).append("svg").attr("id",this.options.idSvg).attr("width","100%").attr("height","100%")},t.update=function(t,n){"pie3d"===this.options.type&&(this.Pie3d||(n&&this.setOptions(n),this.Pie3d=new ve(this.options)),this.Pie3d.draw(t))},n.init=function(t){return new n(t||{})},n}()});
